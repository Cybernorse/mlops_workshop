schema: '2.0'
stages:
  preprocessing:
    cmd: python src/preprocessing.py --config=params.yaml
    deps:
    - path: src/preprocessing.py
      md5: 083b86b39d4d7a3fe2f081b0a9a511ba
      size: 1864
    params:
      params.yaml:
        preprocessing:
          db_level: 33
          raw_audio_pos: data/raw/cohort_1_pos.npy
          raw_audio_neg: data/raw/cohort_1_neg.npy
          processed_audio_pos: data/preprocessed/pre_cohort_1_pos.npy
          processed_audio_neg: data/preprocessed/pre_cohort_1_neg.npy
    outs:
    - path: data/preprocessed/pre_cohort_1_neg.npy
      md5: adeb2e52033f8e8ad3e721175b63d6e1
      size: 8467328
    - path: data/preprocessed/pre_cohort_1_pos.npy
      md5: 21b1ff995c7d653bb1db683f3c512eba
      size: 17640128
  feature_extraction:
    cmd: python src/feature_extraction.py --config=params.yaml
    deps:
    - path: data/preprocessed/pre_cohort_1_neg.npy
      md5: adeb2e52033f8e8ad3e721175b63d6e1
      size: 8467328
    - path: data/preprocessed/pre_cohort_1_pos.npy
      md5: 21b1ff995c7d653bb1db683f3c512eba
      size: 17640128
    - path: src/feature_extraction.py
      md5: cb8499a3703b47e12de327ed4a955ba9
      size: 4329
    params:
      params.yaml:
        audio_&_feature:
          sampling_rate: 22050
          axis: 0
          n_mfcc: 40
          n_mels: 40
          fmax: 4000
          n_chroma: 36
        feature_extraction:
          features_path: data/features/covid_features.csv
          target_column: status
        preprocessing:
          db_level: 33
          raw_audio_pos: data/raw/cohort_1_pos.npy
          raw_audio_neg: data/raw/cohort_1_neg.npy
          processed_audio_pos: data/preprocessed/pre_cohort_1_pos.npy
          processed_audio_neg: data/preprocessed/pre_cohort_1_neg.npy
    outs:
    - path: data/features/covid_features.csv
      md5: 9c709b044748018a2afad45342bdb7b5
      size: 342133
  data_split:
    cmd: python src/data_split.py --config=params.yaml
    deps:
    - path: data/features/covid_features.csv
      md5: 9c709b044748018a2afad45342bdb7b5
      size: 342133
    - path: src/data_split.py
      md5: fbd5e21768c9c6a8e4cbc3a9295977d1
      size: 956
    params:
      params.yaml:
        base:
          random_state: 42
        data_split:
          test_size: 0.2
          trainset_path: data/features/train.csv
          testset_path: data/features/test.csv
        feature_extraction:
          features_path: data/features/covid_features.csv
          target_column: status
    outs:
    - path: data/features/test.csv
      md5: eb84aaf05082d8481565caf14198aaeb
      size: 71114
    - path: data/features/train.csv
      md5: ca8fa01143960b8b74645e3b6a5d034f
      size: 272235
  train:
    cmd: python src/train_and_evaluate.py --config=params.yaml
    deps:
    - path: data/features/test.csv
      md5: eb84aaf05082d8481565caf14198aaeb
      size: 71114
    - path: data/features/train.csv
      md5: ca8fa01143960b8b74645e3b6a5d034f
      size: 272235
    - path: src/train_and_evaluate.py
      md5: a5e44347cad2a954462081f059860df1
      size: 3481
    params:
      params.yaml:
        base:
          random_state: 42
        data_split:
          test_size: 0.2
          trainset_path: data/features/train.csv
          testset_path: data/features/test.csv
        evaluate:
          reports_dir: reports
          metrics_file: metrics.json
          confusion_matrix_image: confusion_matrix.png
          confusion_matrix_data: confusion_matrix_data.csv
        feature_extraction.target_column: status
        train:
          model_path: models/xgb_models.joblib
    outs:
    - path: models/xgb_models.joblib
      md5: b9ba4e1c89e08a826f2bf6fb02e13b8c
      size: 529088
    - path: reports/confusion_matrix.png
      md5: f4ecb2459f73685e488755b5bbe3a4ad
      size: 23411
    - path: reports/metrics.json
      md5: f778a41c59c26446419deb903c8d2b42
      size: 32
